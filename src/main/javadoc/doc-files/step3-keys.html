<!--
  ~ This is free and unencumbered software released into the public domain.
  -->
<html>
<head>
    <title>Package Documentation for com.mycompany web app demo</title>
    <a href="../overview-summary.html">Back to top</a>
</head>
<body>
<p>
<hr>
<h3>Step 3 - Create SSL Keys</h3>
Instructions to generate public/private keys used for Fortress security demo #2.
<ol>
    <li>
        Create a folder to work in:
        <pre>
            $ mkdir certs
            $ cd certs
            ~certs$
        </pre>
    </li>

    <li>
        Create CA certificate:
        <ol type="a">

            <li>
                Generate new RSA private key:
                <ol type="i">

                    <li>
                        Create private key:
                        <pre>
                            ~/certs$ openssl genrsa 2048 > ca-key.pem
                            Generating RSA private key, 2048 bit long modulus
                            .....+++
                            ...............................................................................................................................................................+++
                            e is 65537 (0x10001)
                        </pre>
                    </li>

                    <li>
                        verify:
                        <pre>
                            ~/certs$ ls
                            ca-key.pem
                        </pre>
                    </li>

                    <li>
                        ca-key.pem is private key
                    </li>

                </ol>

            </li>

            <br>

            <li>
                Generate Certificate Request:
                <pre>
                    ~/certs$ openssl req -new -x509 -nodes -days 3600 -key ca-key.pem -out ca-cert.pem
                    You are about to be asked to enter information that will be incorporated
                    into your certificate request.
                    What you are about to enter is what is called a Distinguished Name or a DN.
                    There are quite a few fields but you can leave some blank
                    For some fields there will be a default value,
                    If you enter '.', the field will be left blank.
                    -----
                </pre>

                <ol type="i">

                    <li>
                        Set country:
                        <pre>
                            Country Name (2 letter code) [AU]:US
                        </pre>

                    </li>

                    <li>
                        Set state:
                        <pre>
                            State or Province Name (full name) [Some-State]:California
                        </pre>
                    </li>
                    <li>
                        Set city:
                        <pre>
                            Locality Name (eg, city) []:Joshua Tree
                        </pre>

                    </li>

                    <li>
                        Set Organization name:
                        <pre>
                            Organization Name (eg, company) [Internet Widgits Pty Ltd]:mycompanyname
                        </pre>

                    </li>

                    <li>
                        Set Organiational Unit Name (this may be left blank):
                        <pre>
                            Organizational Unit Name (eg, section) []:mygroupname
                        </pre>
                    </li>

                    <li>
                        Set Common Name, i.e. hostname of target machine.  Note this is the most important setting and name you specify here must match the
                        value entered in Step 1.
                        <pre>
                            Common Name (e.g. server FQDN or YOUR name) []:fortressdemo2.com
                        </pre>
                    </li>

                    <li>
                        Set Email Address (this may be left blank):
                        <pre>
                            Email Address []:
                        </pre>
                    </li>
                </ol>

            </li>

            <br>

            <li>
                verify certificate present (ca-cert.pem):
                <pre>
                    ~/certs$ ls
                    ca-cert.pem  ca-key.pem
                </pre>
            </li>

        </ol>




    </li>

    <li>
        Create server certificate:
        <ol type="i">

            <li>
                Create new server keys:
                <pre>
                    ~/certs$ openssl req -newkey rsa:2048 -days 1825 -nodes -keyout server-key.pem -out server-req.pem
                    Generating a 2048 bit RSA private key
                    ................................................................................................................................................+++
                    ........................+++
                    writing new private key to 'server-key.pem'
                    -----
                    You are about to be asked to enter information that will be incorporated
                    into your certificate request.
                    What you are about to enter is what is called a Distinguished Name or a DN.
                    There are quite a few fields but you can leave some blank
                    For some fields there will be a default value,
                    If you enter '.', the field will be left blank.
                </pre>
            </li>

            <li>
                Step through the prompts:
                <pre>
                    Country Name (2 letter code) [AU]:US
                    State or Province Name (full name) [Some-State]:California
                    Locality Name (eg, city) []:Joshua Tree
                    Organization Name (eg, company) [Internet Widgits Pty Ltd]:mycompanyname
                    Organizational Unit Name (eg, section) []:mygroupname
                    Common Name (e.g. server FQDN or YOUR name) []:Shawn McKinney
                    Email Address []:

                    Please enter the following 'extra' attributes
                    to be sent with your certificate request
                    A challenge password []:changeit
                    An optional company name []:
                </pre>
            </li>

            <li>
                Remove the pass phrase on an RSA private key:
                <pre>
                    ~/certs$ openssl rsa -in server-key.pem -out server-key.pem
                    writing RSA key
                </pre>
            </li>

            <li>
                Sign the public certificate:
                <pre>
                    ~/certs$ openssl x509 -req -in server-req.pem -days 1825 -CA ca-cert.pem -CAkey ca-key.pem -set_serial 01 -out server-cert.pem
                    Signature ok
                    subject=/C=US/ST=California/L=Joshua Tree/O=mycompanyname/OU=mygroupname/CN=Shawn McKinney
                </pre>
            </li>

            <li>
                The following files will be used later:
                <pre>
                    ~/certs$ ls
                    ca-cert.pem  server-cert.pem  server-key.pem
                </pre>
            </li>
        </ol>
    </li>
</ol>
</body>
</html>
